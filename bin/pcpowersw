#!/bin/sh

if [ -z "$(which gpio 2> /dev/null)" ]; then
	echo "command not found : gpio"
	exit 1
fi

if [[ "${UID}" -ne 0 ]]; then
	sudo "${0}" $*
	exit ${?}
fi

gpio mode 1 in
LED=$(gpio read 1)
if [[ "${LED}" == "1" ]]; then
	echo "PC Power LED Status : On"
else
	echo "PC Power LED Status : Off"
fi

gpio mode 8 out
gpio write 8 0
echo "PC Power Switch Pressed"
if [[ "${1}" == "--force" ]] || [[ "${1}" == "-force" ]] || [[ "${1}" == "-f" ]]; then
	sleep 5.5
else
	sleep 0.5
fi
gpio write 8 1

sleep 0.5
LED=$(gpio read 1)
if [[ "${LED}" == "1" ]]; then
	echo "PC Power LED Status : On"
else
	echo "PC Power LED Status : Off"
fi

exit 0
